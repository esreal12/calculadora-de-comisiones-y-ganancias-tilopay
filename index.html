<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora de Ganancia · v2</title>
  <!-- Cache busting for GitHub Pages -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <style>
    :root{--bg:#0b0b10;--panel:#12121a;--muted:#9aa0aa;--text:#e9eef5;--brand:#7AF401;--border:#232334}
    *{box-sizing:border-box}
    body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;background:var(--bg);color:var(--text);min-height:100dvh;display:grid;place-items:start center;padding:32px}
    .wrap{width:100%;max-width:520px;background:#14141e;border:1px solid var(--border);border-radius:16px;padding:22px;box-shadow:0 8px 30px rgba(0,0,0,.25)}
    h1{margin:0 0 4px 0;font-size:22px}
    .muted{color:var(--muted);margin-bottom:18px}
    label{display:block;margin:12px 0 6px 0}
    input{width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);background:#0f0f18;color:var(--text);font-size:16px}
    button{width:100%;margin-top:10px;padding:12px;border-radius:10px;border:1px solid var(--border);background:#1a1a26;color:var(--text);font-weight:700;cursor:pointer}
    button:hover{border-color:var(--brand);color:var(--brand)}
    .result{margin-top:12px;padding:12px;border:1px solid var(--border);border-radius:12px;background:#0f0f18}
    .row{display:flex;justify-content:space-between;margin:6px 0}
    .brand{color:var(--brand)}
    .small{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Calculadora de Ganancia <span class="brand">v2</span></h1>
    <div class="muted">Comisión: <strong>4.8%</strong> + <strong>$0.40</strong> por transacción</div>

    <label for="monto">¿Cuánto desea cobrar? ($)</label>
    <input type="number" id="monto" placeholder="Ej. 100" step="0.01" min="0" />
    <button id="btn-calc">Calcular ganancia neta</button>
    <div id="out-neto" class="result" hidden></div>

    <label for="neto">¿Cuánto desea recibir neto? ($)</label>
    <input type="number" id="neto" placeholder="Ej. 100" step="0.01" min="0" />
    <button id="btn-inverso">Calcular monto a cobrar</button>
    <div id="out-inverso" class="result" hidden></div>

<!--     <div class="small" style="margin-top:10px">Sugerencia: si tu navegador muestra la versión anterior, usa <strong>Hard Reload</strong> (Cmd+Shift+R / Ctrl+F5). Esta página además envía cabeceras de no-cache a través de meta tags.</div> -->
  </div>

  <script>
    const P = 0.048; // porcentaje
    const F = 0.40;  // fija

    const fmt = v => `$${Number(v).toFixed(2)}`;

    function calcNeto(monto){
      const comision = monto * P + F;
      const neto = monto - comision;
      return {comision, neto};
    }

    function calcBruto(netoDeseado){
      const bruto = (netoDeseado + F) / (1 - P);
      const comision = bruto - netoDeseado;
      return {bruto, comision};
    }

    const outN = document.getElementById('out-neto');
    const outI = document.getElementById('out-inverso');

    document.getElementById('btn-calc').addEventListener('click', ()=>{
      const monto = parseFloat(document.getElementById('monto').value);
      if(!monto || monto<=0){ outN.hidden=false; outN.textContent='Ingrese un monto válido.'; return; }
      const {comision, neto} = calcNeto(monto);
      outN.hidden=false;
      outN.innerHTML = `
        <div class="row"><span>Comisión total</span><strong>${fmt(comision)}</strong></div>
        <div class="row"><span>Usted recibirá</span><strong class="brand">${fmt(neto)}</strong></div>
      `;
    });

    document.getElementById('btn-inverso').addEventListener('click', ()=>{
      const neto = parseFloat(document.getElementById('neto').value);
      if(!neto || neto<=0){ outI.hidden=false; outI.textContent='Ingrese una cifra neta válida.'; return; }
      const {bruto, comision} = calcBruto(neto);
      outI.hidden=false;
      outI.innerHTML = `
        <div class="row"><span>Debe cobrar</span><strong class="brand">${fmt(bruto)}</strong></div>
        <div class="row"><span>Comisión estimada</span><strong>${fmt(comision)}</strong></div>
      `;
    });

    // Version visible para depurar caché
    console.log('Calculator version v2', new Date().toISOString());
  </script>
</body>
</html>
